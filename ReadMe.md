
###`README.md`

```markdown
# ๐ฆท Tooth Decay Detection โ Dental X-ray Pipeline

ุงู ูพุฑูฺู ฺฉ **ูพุงูพโูุงู ฺฉุงูู ูพุฑุฏุงุฒุด ู ุงุฏฺฏุฑ ุนูู** ุจุฑุง ุชุดุฎุต ูพูุณุฏฺฏ ุฏูุฏุงู ุงุฒ ุฑู ุชุตุงูุฑ ุฑุงุฏูฺฏุฑุงู (X-ray) ุงุณุช.  
ูุฑุงุญู ุจู ุชุฑุชุจ:
1. ๐ฅ ุฏุงูููุฏ ู ูพุดโูพุฑุฏุงุฒุด ุชุตุงูุฑ (ุญุฐู ููุฒุ ููุงุฑ ุณูุฏุ ุจูุจูุฏ ฺฉูุชุฑุงุณุชุ ุงูุฒุงุด ุฏุงุฏู)  
2. ๐ง ุขููุฒุด ฺฉ ูุฏู ุทุจููโุจูุฏ (ResNet18) ุจุฑุง ุชุดุฎุต ยซุณุงููยป ุง ยซูพูุณุฏูยป  
3. ๐ ูพุดโุจู ู ุชููุฏ ุฎุฑูุฌโูุง ุชุตูุฑ ุจุง ุงุณุชูุงุฏู ุงุฒ **Grad-CAM** (ุฏุงุฑูุ ฺฉุงูุชูุฑุ ููุด ู ูุชโููพ)

---

## ๐ ุณุงุฎุชุงุฑ ูพุฑูฺู

```

Tooth\_Decay/
โ
โโโ main.py                     # ุงุฌุฑุง ฺฉู ูุฑุงุญู (preprocess + train + predict)
โโโ requirements.txt            # ูุณุช ฺฉุชุงุจุฎุงููโูุง
โโโ README.md                   # ุงู ูุงู
โโโ .gitignore
โ
โโโ preprocess/
โ   โโโ preprocess.py           # ุฏุงูููุฏ ู ูพุดโูพุฑุฏุงุฒุด ุชุตุงูุฑ
โ   โโโ xray\_images/            # ุชุตุงูุฑ ุฎุงู ุฏุงูููุฏุดุฏู ุงุฒ Arvan
โ   โโโ preprocessed\_images/    # ุชุตุงูุฑ ูพุฑุฏุงุฒุดโุดุฏู (224x224ุ augmentation)
โ
โโโ processing/
โ   โโโ ToothClassifier.py      # ุชุนุฑู ูุฏู ResNet18
โ   โโโ train\_model.py          # ุขููุฒุด ูุฏู
โ   โโโ predict.py              # ูพุดโุจู + Grad-CAM
โ   โโโ tooth\_classifier.pth    # ูุฒูโูุง ูุฏู ุฐุฎุฑูโุดุฏู (ุจุนุฏ ุงุฒ train)
โ   โโโ predict\_output/         # ุฎุฑูุฌโูุง ูพุดโุจู
โ       โโโ <image1>/
โ       โ   โโโ original.jpg
โ       โ   โโโ prediction\_circle.jpg
โ       โ   โโโ prediction\_heatmap.jpg
โ       โ   โโโ prediction\_gradcam.jpg
โ       โ   โโโ prediction\_arrow\.jpg
โ       โ   โโโ prediction\_arrow\_circle.jpg
โ       โโโ <image2>/ ...
โ
โโโ xray\_pic/                   # (ุงุฎุชุงุฑ) ุงฺฏุฑ ุนฺฉุณ ุฏุฑ ุงู ูพูุดู ูุฑุงุฑ ุจฺฏุฑุฏุ
\# ููุงู ุนฺฉุณโูุง ุจู ุฌุง ุฏุงุฏูโูุง ูพุดโูพุฑุฏุงุฒุดโุดุฏู
\# ุจุฑุง predict ุงุณุชูุงุฏู ูโุดููุฏ.

````

---

## โ๏ธ ูุตุจ ู ุงุฌุฑุง

### 1) ูุตุจ ฺฉุชุงุจุฎุงููโูุง
ุงุจุชุฏุง ูพฺฉุฌโูุง ุฑุง ูุตุจ ฺฉูุฏ (ุชุฑุฌุญุงู ุฏุฑ ูุญุท ูุฌุงุฒ):

```bash
pip install -r requirements.txt
````

> โ๏ธ ุชูุฌู: ูุณุฎูโ `numpy<2.0` ุงูุชุฎุงุจ ุดุฏู ฺูู PyTorch ูุนูุงู ุจุง NumPy 2.x ูุงุณุงุฒฺฏุงุฑ ุงุณุช.

ุจุฑุง ูุตุจ PyTorch ุฑู GPU/CUDA ุจุงุฏ ุฏุณุชูุฑ ููุงุณุจ ุฑุง ุงุฒ [ูุจโุณุงุช PyTorch](https://pytorch.org/get-started/locally/) ุจฺฏุฑุฏ. ูุซุงู (CUDA 11.8):

```bash
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
```

---

### 2) ุงุฌุฑุง ฺฉุงูู ูพุฑูฺู

ุจุง ุงุฌุฑุง ฺฉ ุฏุณุชูุฑุ ฺฉู pipeline ุงูุฌุงู ูโุดูุฏ:

```bash
python main.py
```

ุงู ูุฑุงุญู ุงูุฌุงู ูโุดูุฏ:

1. ุฏุงูููุฏ ู ูพุดโูพุฑุฏุงุฒุด ุชุตุงูุฑ ุงุฒ Arvan โ `preprocess/preprocessed_images/`
2. ุขููุฒุด ูุฏู โ `processing/tooth_classifier.pth`
3. ูพุดโุจู ู ุชููุฏ ุฎุฑูุฌโูุง Grad-CAM โ `processing/predict_output/`

---

### 3) ุญุงูุช ูพุดโุจู

* ุงฺฏุฑ ุฏุงุฎู ูพูุดูโ `xray_pic/` ุชุตูุฑ ูุฑุงุฑ ุฏูุฏ โ ููุงูโูุง ุงุณุชูุงุฏู ูโุดููุฏ.
* ุงฺฏุฑ ุงู ูพูุดู ุฎุงู ุจุงุดุฏ โ ุจูโุตูุฑุช ุชุตุงุฏู **ฑฐฐ ุชุตูุฑ** ุงุฒ `preprocess/preprocessed_images/` ุงูุชุฎุงุจ ูโุดูุฏ ู ุจุฑุง ูุฑ ุชุตูุฑ ฺฉ ูููุฏุฑ ุฎุฑูุฌ ุณุงุฎุชู ูโุดูุฏ.

---

## ๐ ุฎุฑูุฌโูุง Grad-CAM

ุจุฑุง ูุฑ ุชุตูุฑ ูุฑูุฏ ฺูุฏู ุฎุฑูุฌ ุณุงุฎุชู ูโุดูุฏ:

* **original.jpg** โ ุชุตูุฑ ุงุตู
* **prediction\_circle.jpg** โ ูุงุญู ูุดฺฉูฺฉ ุจุง ุฏุงุฑู ูุฑูุฒ ู ฺฉุงูุชูุฑ ุณุจุฒ
* **prediction\_heatmap.jpg** โ ูุชโููพ Grad-CAM
* **prediction\_gradcam.jpg** โ ูุชโููพ ุฑู ุชุตูุฑ ุงุตู ุจุง ุฏุงุฑู/ฺฉุงูุชูุฑ
* **prediction\_arrow\.jpg** โ ููุด ุงุดุงุฑู ุจู ูุงุญู ูุดฺฉูฺฉ
* **prediction\_arrow\_circle.jpg** โ ุชุฑฺฉุจ ุฏุงุฑู + ููุด

---

## ๐งช ูฺฉุงุช ูู

* ูุนูุงุฑ ุงุณุชูุงุฏูโุดุฏู: **ResNet18**
* ุฏุงุฏูโูุง ุจุง ุงุณุชูุงุฏู ุงุฒ **Albumentations** ุงูุฒุงุด ุฏุงุฏู ุดุฏูโุงูุฏ.
* ูพุดโูพุฑุฏุงุฒุด ุดุงูู: ุจุฑุด ููุงุฑ ุณูุฏุ CLAHEุ ููุชุฑ Median + Bilateralุ Gaussian Blur
* ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุงุดุชุจุงู ุฑู ูพุณโุฒูููโ ุณุงูุ ุงุฒ **ROI Mask** (ูุงุญู ูฺฉ/ุฏูุฏุงู) ุงุณุชูุงุฏู ุดุฏู ุงุณุช.

---

## โ Troubleshooting (ุฑูุน ุฎุทุงูุง)

๐ด **ุฎุทุง NumPy ุจุง PyTorch**

* ูพุงู: *"A module that was compiled using NumPy 1.x cannot be run in NumPy 2.x..."*
* ุฑุงูโุญู:

  ```bash
  pip install "numpy<2.0"
  ```

๐ด **ุฎุทุง ุฏุงูููุฏ ูุฒู ResNet18**

* ุงฺฏุฑ ุงูุชุฑูุช ุง ุชุญุฑู ูุดฺฉู ุงุฌุงุฏ ฺฉุฑุฏุ ูโุชูุงูุฏ:

  * ูุฒูโูุง ResNet18 ุฑุง ุฏุณุช ุฏุงูููุฏ ฺฉูุฏ ู ุฏุฑ ูุณุฑ
    `~/.cache/torch/hub/checkpoints/resnet18-*.pth` ูุฑุงุฑ ุฏูุฏ.
  * ุง ุฏุฑ ฺฉุฏ `ToothClassifier.py` ูพุงุฑุงูุชุฑ `use_imagenet_weights=False` ุจุฏูุฏ.

๐ด **ุฏุงูููุฏ ุงุฒ Arvan ฺฉุงุฑ ููโฺฉูุฏ**

* ูุทูุฆู ุดูุฏ ฺฉูุฏูุง `access_key` ู `secret_key` ุฏุฑุณุช ูุณุชูุฏ.
* ูพูุดูโ `xray_images/` ุฑุง ฺฺฉ ฺฉูุฏ ฺฉู ุชุตุงูุฑ ุฐุฎุฑู ุดุฏู ุจุงุดูุฏ.
* ุงฺฏุฑ ููฺูุงู ูุดฺฉู ุจูุฏุ `DOWNLOAD_FROM_S3 = False` ุชูุธู ฺฉูุฏ ู ุชุตุงูุฑ ุฑุง ุฏุณุช ุฏุฑ `preprocess/xray_images/` ุจุฑุฒุฏ.

๐ด **GPU ูพุฏุง ูุดุฏ / ููุท CPU ุงุณุชูุงุฏู ูโุดูุฏ**

* ูุทูุฆู ุดูุฏ PyTorch GPU ูุตุจ ฺฉุฑุฏูโุงุฏ (ุจุง ุฏุณุชูุฑ ูุฎุตูุต CUDA).
* ุจุฑุฑุณ ฺฉูุฏ ฺฉุงุฑุช ฺฏุฑุงูฺฉ ุชูุณุท `nvidia-smi` ุดูุงุณุง ุดูุฏ.
* ุงฺฏุฑ GPU ูุฏุงุฑุฏ โ ุฑู CPU ูู ุงุฌุฑุง ูโุดูุฏุ ููุท ฺฉูุฏุชุฑ.

๐ด **ูุตุฑู ุฒุงุฏ RAM/CPU ุฏุฑ ุฒูุงู ุงุฌุฑุง**

* ุชุนุฏุงุฏ `num_workers` ุฏุฑ DataLoader (`train_model.py`) ุฑุง ฺฉุงูุด ุฏูุฏ (ุญุช ุจู 0).
* ุณุงุฒ Batch (`BATCH_SIZE`) ุฑุง ฺฉูฺฺฉโุชุฑ ฺฉูุฏ.
* ูุฑูุฑฺฏุฑ ุง ุจุฑูุงููโูุง ุณูฺฏู ุฏฺฏุฑ ุฑุง ููุฒูุงู ุจุงุฒ ูฺฉูุฏ.

---

## ๐ฏ ูุณุฑูุง ุจุนุฏ

* ุจูุจูุฏ ุฏุชุงุณุช ุจุง ุจุฑฺุณุจโูุง ุฏููโุชุฑ (Bounding Box ุง Mask ุฏูุฏุงูโูุง)
* ุฌุงฺฏุฒู ูุฏู ุทุจููโุจูุฏ ุจุง ูุฏูโูุง **Object Detection** (YOLOv8, Faster R-CNN) ุจุฑุง ุชุนู ุฏููโุชุฑ ูุญู ูพูุณุฏฺฏ
* ุงุณุชูุงุฏู ุงุฒ **Focal Loss** ุจุฑุง ุจุงูุงูุณ ฺฉูุงุณโูุง

---

```

